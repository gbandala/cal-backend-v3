# ü§ù Gu√≠a de Contribuci√≥n - Cal Backend V2

> ¬°Gracias por tu inter√©s en contribuir a Cal Backend V2! Esta gu√≠a te ayudar√° a participar de manera efectiva en el proyecto.

## üìã √çndice

- [C√≥digo de Conducta](#-c√≥digo-de-conducta)
- [Formas de Contribuir](#-formas-de-contribuir)
- [Configuraci√≥n de Desarrollo](#-configuraci√≥n-de-desarrollo)
- [Proceso de Contribuci√≥n](#-proceso-de-contribuci√≥n)
- [Est√°ndares de C√≥digo](#-est√°ndares-de-c√≥digo)
- [Gu√≠a de Commits](#-gu√≠a-de-commits)
- [Testing](#-testing)
- [Documentaci√≥n](#-documentaci√≥n)

## üìú C√≥digo de Conducta

### Nuestro Compromiso

Como contribuyentes y mantenedores de este proyecto, nos comprometemos a hacer de la participaci√≥n en nuestro proyecto y nuestra comunidad una experiencia libre de acoso para todos.

### Est√°ndares

Ejemplos de comportamiento que contribuyen a crear un ambiente positivo:

‚úÖ **Hacer:**
- Usar lenguaje acogedor e inclusivo
- Ser respetuoso con diferentes puntos de vista y experiencias
- Aceptar cr√≠ticas constructivas de manera elegante
- Enfocarse en lo que es mejor para la comunidad
- Mostrar empat√≠a hacia otros miembros de la comunidad

‚ùå **No hacer:**
- Usar lenguaje o im√°genes sexualizadas
- Hacer comentarios insultantes o despectivos
- Acosar p√∫blicamente o en privado
- Publicar informaci√≥n privada de otros sin permiso
- Cualquier otra conducta que se considerar√≠a inapropiada en un entorno profesional

## üéØ Formas de Contribuir

### üêõ Reportar Bugs

**Antes de reportar un bug:**
- Verifica que no exista un issue similar
- Aseg√∫rate de estar usando la √∫ltima versi√≥n
- Prueba en un entorno limpio

**Template para reportar bugs:**
```markdown
## Descripci√≥n del Bug
Descripci√≥n clara y concisa del problema.

## Pasos para Reproducir
1. Ir a '...'
2. Hacer clic en '...'
3. Scroll hasta '...'
4. Ver error

## Comportamiento Esperado
Descripci√≥n clara de lo que esperabas que pasara.

## Comportamiento Actual
Descripci√≥n clara de lo que realmente pasa.

## Capturas de Pantalla
Si aplica, agregar capturas para explicar el problema.

## Entorno
- OS: [ej. macOS 12.6]
- Node.js: [ej. v18.12.0]
- PostgreSQL: [ej. v14.5]
- Navegador: [ej. Chrome 108.0]

## Contexto Adicional
Cualquier otra informaci√≥n relevante sobre el problema.
```

### üí° Sugerir Funcionalidades

**Template para nuevas funcionalidades:**
```markdown
## Descripci√≥n de la Funcionalidad
Descripci√≥n clara y concisa de la funcionalidad que te gustar√≠a ver.

## Problema que Resuelve
¬øQu√© problema espec√≠fico resuelve esta funcionalidad?

## Soluci√≥n Propuesta
Descripci√≥n clara de c√≥mo te gustar√≠a que funcionara.

## Alternativas Consideradas
Otras soluciones o funcionalidades que has considerado.

## Impacto
- ¬øA qui√©n beneficia esta funcionalidad?
- ¬øQu√© tan cr√≠tica es?
- ¬øHay workarounds actuales?
```

### üîß Contribuir con C√≥digo

**√Åreas donde necesitamos ayuda:**
- üîê Mejoras de seguridad
- üìä Optimizaci√≥n de base de datos
- üåê Nuevas integraciones (Zoom, Microsoft)
- üé® Mejoras de API
- üìù Documentaci√≥n
- üß™ Testing
- üêõ Correcci√≥n de bugs

## üõ†Ô∏è Configuraci√≥n de Desarrollo

### 1. Fork y Clone

```bash
# Fork el repositorio en GitHub
# Luego clona tu fork

git clone https://github.com/TU_USERNAME/cal-backend-v2.git
cd cal-backend-v2

# Agregar el repositorio original como upstream
git remote add upstream https://github.com/gbandala/cal-backend-v2.git
```

### 2. Configurar Entorno

```bash
# Instalar dependencias
npm install

# Configurar variables de entorno
cp .env.example .env
# Editar .env con tus configuraciones

# Configurar base de datos de desarrollo
npm run db:setup:dev
```

### 3. Verificar Configuraci√≥n

```bash
# Ejecutar tests
npm test

# Ejecutar linting
npm run lint

# Ejecutar en modo desarrollo
npm run dev
```

## üîÑ Proceso de Contribuci√≥n

### 1. Planificaci√≥n

```bash
# Mantener tu fork actualizado
git checkout main
git pull upstream main
git push origin main

# Crear rama para tu funcionalidad
git checkout -b feature/nombre-descriptivo
# o
git checkout -b fix/descripcion-del-fix
```

### 2. Desarrollo

```bash
# Hacer cambios
# Agregar tests para nueva funcionalidad
# Actualizar documentaci√≥n si es necesario

# Verificar que todo funciona
npm test
npm run lint
npm run build
```

### 3. Commits

Seguir [Conventional Commits](https://www.conventionalcommits.org/):

```bash
# Ejemplos de commits v√°lidos:
git commit -m "feat: add calendar-specific event creation"
git commit -m "fix: resolve timezone conversion bug"
git commit -m "docs: update API documentation for meetings"
git commit -m "test: add unit tests for date handling"
```

### 4. Pull Request

```bash
# Push a tu fork
git push origin feature/nombre-descriptivo

# Crear Pull Request en GitHub
```

**Template para Pull Request:**
```markdown
## Descripci√≥n
Resumen claro de los cambios y qu√© problema resuelve.

Fixes #(issue_number)

## Tipo de Cambio
- [ ] Bug fix (cambio no-breaking que corrige un issue)
- [ ] Nueva funcionalidad (cambio no-breaking que agrega funcionalidad)
- [ ] Breaking change (fix o funcionalidad que causa que funcionalidad existente no funcione como esperado)
- [ ] Cambio de documentaci√≥n

## ¬øC√≥mo se ha Probado?
Describe las pruebas que realizaste para verificar tus cambios.

- [ ] Test unitarios
- [ ] Test de integraci√≥n
- [ ] Test manual
- [ ] Test en diferentes navegadores

## Checklist
- [ ] Mi c√≥digo sigue las pautas de estilo del proyecto
- [ ] He realizado una auto-revisi√≥n de mi c√≥digo
- [ ] He comentado mi c√≥digo, particularmente en √°reas dif√≠ciles de entender
- [ ] He realizado los cambios correspondientes en la documentaci√≥n
- [ ] Mis cambios no generan nuevas advertencias
- [ ] He agregado tests que prueban que mi fix es efectivo o que mi funcionalidad funciona
- [ ] Tests nuevos y existentes pasan localmente con mis cambios
- [ ] Cualquier cambio dependiente ha sido fusionado y publicado
```

## üìù Est√°ndares de C√≥digo

### TypeScript/JavaScript

```typescript
// ‚úÖ Buenas Pr√°cticas

// 1. Usar tipos expl√≠citos
interface UserCreateRequest {
  name: string;
  email: string;
  password: string;
}

// 2. Manejo de errores consistente
try {
  const user = await userService.createUser(userData);
  return success(user);
} catch (error) {
  logger.error('Error creating user:', error);
  return failure('USER_CREATION_FAILED', error.message);
}

// 3. Validaci√≥n de entrada
@IsEmail()
@IsNotEmpty()
email: string;

// 4. Nomenclatura clara
const getUserMeetingsService = async (userId: string, filter: MeetingFilterEnum) => {
  // Implementation
};

// 5. Documentaci√≥n con JSDoc
/**
 * Creates a new meeting in the specified calendar
 * @param eventId - ID of the event to create meeting for
 * @param meetingData - Meeting details
 * @returns Promise<Meeting> - Created meeting with Google Calendar ID
 */
```

### Estructura de Archivos

```
src/
‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îú‚îÄ‚îÄ auth.controller.ts      # L√≥gica de endpoints
‚îÇ   ‚îî‚îÄ‚îÄ meeting.controller.ts
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ auth.service.ts         # L√≥gica de negocio
‚îÇ   ‚îî‚îÄ‚îÄ meeting.service.ts
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îú‚îÄ‚îÄ entities/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ User.ts            # Entidades TypeORM
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Meeting.ts
‚îÇ   ‚îî‚îÄ‚îÄ dto/
‚îÇ       ‚îú‚îÄ‚îÄ CreateUserDto.ts   # DTOs de validaci√≥n
‚îÇ       ‚îî‚îÄ‚îÄ CreateMeetingDto.ts
‚îú‚îÄ‚îÄ middlewares/
‚îÇ   ‚îú‚îÄ‚îÄ auth.middleware.ts     # Middlewares reutilizables
‚îÇ   ‚îî‚îÄ‚îÄ validation.middleware.ts
‚îî‚îÄ‚îÄ utils/
    ‚îú‚îÄ‚îÄ date.utils.ts          # Utilidades espec√≠ficas
    ‚îî‚îÄ‚îÄ calendar.utils.ts
```

### Naming Conventions

```typescript
// Variables y funciones: camelCase
const userMeetings = [];
const getCurrentUser = () => {};

// Clases y interfaces: PascalCase
class MeetingService {}
interface UserData {}

// Constantes: SCREAMING_SNAKE_CASE
const MAX_MEETINGS_PER_DAY = 10;
const DEFAULT_MEETING_DURATION = 30;

// Archivos: kebab-case o camelCase
user-service.ts
userService.ts (ambos aceptables)

// Endpoints: kebab-case
/api/user-meetings
/api/calendar-events
```

## üìù Gu√≠a de Commits

### Conventional Commits

Usamos [Conventional Commits](https://www.conventionalcommits.org/) para mantener un historial limpio:

```bash
<type>[optional scope]: <description>

[optional body]

[optional footer(s)]
```

### Tipos de Commit

| Tipo | Descripci√≥n | Ejemplo |
|------|-------------|---------|
| `feat` | Nueva funcionalidad | `feat: add calendar-specific meeting creation` |
| `fix` | Correcci√≥n de bug | `fix: resolve timezone conversion in date service` |
| `docs` | Cambios en documentaci√≥n | `docs: update API endpoint documentation` |
| `style` | Formato, punto y coma faltante, etc | `style: fix indentation in user controller` |
| `refactor` | Cambio de c√≥digo que no corrige bug ni agrega funcionalidad | `refactor: extract date utility functions` |
| `test` | Agregar tests faltantes | `test: add unit tests for meeting service` |
| `chore` | Cambios en build, dependencias, etc | `chore: update TypeORM to latest version` |

### Ejemplos de Buenos Commits

```bash
# Funcionalidad nueva
feat(meetings): add support for recurring meetings
feat(calendar): integrate with Microsoft Calendar API
feat: implement timezone-aware date handling

# Correcci√≥n de bugs
fix(auth): resolve JWT token expiration handling
fix(meetings): prevent double-booking in same time slot
fix: correct Google Calendar API scope permissions

# Documentaci√≥n
docs(api): add examples for meeting endpoints
docs: update installation guide for PostgreSQL 14
docs(readme): fix typos in setup instructions

# Tests
test(services): add integration tests for calendar sync
test: increase coverage for authentication flows
test(utils): add unit tests for date helpers
```

## üß™ Testing

### Estructura de Tests

```
tests/
‚îú‚îÄ‚îÄ unit/
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.service.test.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ meeting.service.test.ts
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îî‚îÄ‚îÄ date.utils.test.ts
‚îú‚îÄ‚îÄ integration/
‚îÇ   ‚îú‚îÄ‚îÄ auth.integration.test.ts
‚îÇ   ‚îî‚îÄ‚îÄ meetings.integration.test.ts
‚îî‚îÄ‚îÄ fixtures/
    ‚îú‚îÄ‚îÄ users.json
    ‚îî‚îÄ‚îÄ meetings.json
```

### Escribir Tests

```typescript
// ‚úÖ Ejemplo de test unitario
describe('MeetingService', () => {
  describe('createMeeting', () => {
    it('should create meeting in correct calendar', async () => {
      // Arrange
      const eventData = { calendar_id: 'test-calendar' };
      const meetingData = { guestEmail: 'test@test.com' };
      
      // Act
      const result = await meetingService.createMeeting(eventData, meetingData);
      
      // Assert
      expect(result.calendarEventId).toBeDefined();
      expect(googleCalendarMock.createEvent).toHaveBeenCalledWith(
        expect.objectContaining({ calendarId: 'test-calendar' })
      );
    });
  });
});

// ‚úÖ Ejemplo de test de integraci√≥n
describe('POST /api/meeting/public/create', () => {
  it('should create meeting and return 201', async () => {
    const response = await request(app)
      .post('/api/meeting/public/create')
      .send({
        eventId: testEvent.id,
        guestName: 'Test User',
        guestEmail: 'test@example.com',
        startTime: '2025-06-15T10:00:00.000Z',
        endTime: '2025-06-15T10:30:00.000Z'
      })
      .expect(201);
      
    expect(response.body.success).toBe(true);
    expect(response.body.data.meetLink).toContain('meet.google.com');
  });
});
```

### Ejecutar Tests

```bash
# Todos los tests
npm test

# Tests espec√≠ficos
npm test -- auth.service.test.ts

# Tests con coverage
npm run test:coverage

# Tests en modo watch
npm run test:watch

# Tests de integraci√≥n √∫nicamente
npm run test:integration
```

## üìö Documentaci√≥n

### Comentarios en C√≥digo

```typescript
/**
 * Processes meeting dates to remove timezone information for frontend consumption
 * @param meetings - Array of meetings with UTC dates
 * @returns Array of meetings with local time strings (no 'Z' suffix)
 */
const processedMeetings = meetings.map(meeting => {
  // Convert UTC dates to local time strings for frontend
  const processedMeeting = { ...meeting };
  
  if (processedMeeting.startTime) {
    // Remove 'Z' to indicate local time instead of UTC
    const startTimeStr = processedMeeting.startTime.toISOString();
    processedMeeting.startTime = startTimeStr.replace('Z', '') as any;
  }
  
  return processedMeeting;
});
```

### README de Funcionalidades

Para funcionalidades complejas, crear archivos de documentaci√≥n espec√≠ficos:

```
docs/
‚îú‚îÄ‚îÄ features/
‚îÇ   ‚îú‚îÄ‚îÄ calendar-integration.md
‚îÇ   ‚îú‚îÄ‚îÄ timezone-handling.md
‚îÇ   ‚îî‚îÄ‚îÄ meeting-scheduling.md
‚îú‚îÄ‚îÄ architecture/
‚îÇ   ‚îú‚îÄ‚îÄ database-schema.md
‚îÇ   ‚îî‚îÄ‚îÄ api-design.md
‚îî‚îÄ‚îÄ deployment/
    ‚îú‚îÄ‚îÄ production.md
    ‚îî‚îÄ‚îÄ docker.md
```

## üéâ Reconocimientos

Todos los contribuyentes ser√°n reconocidos en:
- README principal
- Archivo CONTRIBUTORS.md
- Release notes
- Agradecimientos especiales para contribuciones significativas

## üìû Contacto

¬øTienes preguntas sobre c√≥mo contribuir?

- üêõ **Issues**: [GitHub Issues](https://github.com/gbandala/cal-backend-v2/issues)
- üí¨ **Discusiones**: [GitHub Discussions](https://github.com/gbandala/cal-backend-v2/discussions)
- üìß **Email**: [gbandala@example.com](mailto:gbandala@example.com)

---

**¬°Gracias por contribuir a Cal Backend V2! üöÄ**

Tu contribuci√≥n hace que este proyecto sea mejor para todos. Cada l√≠nea de c√≥digo, cada bug reportado, cada sugerencia cuenta.